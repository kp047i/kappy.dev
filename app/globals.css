/* stylelint-disable function-no-unknown */
/* stylelint-disable at-rule-no-unknown */
@tailwind base;
@tailwind components;
@tailwind utilities;

* {
  box-sizing: border-box;
  padding: 0;
  margin: 0;
}

html,
body {
  max-width: 100vw;
}

@layer base {
  html {
    color-scheme: light;
  }

  html.dark {
    color-scheme: dark;
  }

  body {
    font-size: theme("fontSize.base");
    font-weight: theme("fontWeight.normal");
    line-height: 1.5;
    letter-spacing: 0.15em;

    @apply transition-colors duration-300 bg-primary-50 text-secondary-950 dark:bg-base-800 dark:text-base-200;
  }
}

a {
  color: inherit;
  text-decoration: none;
}

@layer components {
  .prose.custom-prose {
    --tw-prose-body: theme("colors.base.900") !important;
    --tw-prose-headings: theme("colors.secondary.950") !important;
    --tw-prose-bold: theme("colors.base.900") !important;
    --tw-prose-links: theme("colors.primary.700") !important;
    --tw-prose-bullets: theme("colors.base.800") !important;
    --tw-prose-hr: theme("colors.secondary.200") !important;
    --tw-prose-quotes: theme("colors.base.800") !important;
    --tw-prose-code: theme("colors.primary.700") !important;
    --tw-prose-th-borders: theme("colors.secondary.200") !important;
    --tw-prose-td-borders: theme("colors.secondary.200") !important;
  }

  .dark .prose.custom-prose {
    --tw-prose-body: theme("colors.base.200") !important;
    --tw-prose-headings: theme("colors.base.200") !important;
    --tw-prose-bold: theme("colors.base.200") !important;
    --tw-prose-links: theme("colors.primary.300") !important;
    --tw-prose-bullets: theme("colors.base.200") !important;
    --tw-prose-hr: theme("colors.base.700") !important;
    --tw-prose-quotes: theme("colors.base.200") !important;
    --tw-prose-code: theme("colors.primary.200") !important;
    --tw-prose-th-borders: theme("colors.base.700") !important;
    --tw-prose-td-borders: theme("colors.base.700") !important;
  }

  /* rehype-pretty-code のスタイル */
  .prose pre {
    @apply rounded-lg;

    /* rehype-pretty-code のインラインスタイルを尊重 */
    background-color: var(--shiki-light-bg) !important;
  }

  .dark .prose pre {
    background-color: var(--shiki-dark-bg) !important;
  }

  .prose pre code {
    @apply block overflow-x-auto;

    background: transparent !important;
  }

  /* rehype-pretty-code が生成する span の色を適用 */
  .prose pre code span {
    color: var(--shiki-light) !important;
  }

  .dark .prose pre code span {
    color: var(--shiki-dark) !important;
  }

  .prose pre code[data-line-numbers] {
    counter-reset: line;
  }

  .prose pre code[data-line-numbers] > [data-line]::before {
    content: counter(line);
    counter-increment: line;

    @apply inline-block w-8 mr-4 text-right text-gray-500 dark:text-gray-400;
  }

  @media (prefers-color-scheme: dark) {
    .prose pre code[data-line-numbers] > [data-line]::before {
      @apply text-gray-400;
    }
  }

  .prose pre code[data-line-numbers-max-digits="2"] > [data-line]::before {
    @apply w-8;
  }

  .prose pre code[data-line-numbers-max-digits="3"] > [data-line]::before {
    @apply w-10;
  }

  .prose pre code > [data-line] {
    @apply block px-4;
  }

  .prose pre code > [data-highlighted-line] {
    @apply bg-primary-100 dark:bg-primary-900/30;
  }

  .prose pre code > [data-highlighted-chars] {
    @apply bg-primary-200 dark:bg-primary-800/50 rounded;
  }
}
